From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Business Goose <arclicious@vivaldi.net>
Date: Mon, 4 Apr 2022 00:16:54 +0100
Subject: [PATCH] Prevent abusable entities from being spawned by spawners


diff --git a/src/main/java/net/minecraft/world/level/BaseSpawner.java b/src/main/java/net/minecraft/world/level/BaseSpawner.java
index 569cef8fcb1e3e1e8b66dad4fa9b956b44542bf1..765b9d44cf49a21863fbc0d2c37b761c75237c79 100644
--- a/src/main/java/net/minecraft/world/level/BaseSpawner.java
+++ b/src/main/java/net/minecraft/world/level/BaseSpawner.java
@@ -19,7 +19,9 @@ import net.minecraft.util.StringUtil;
 import net.minecraft.util.random.WeightedRandomList;
 import net.minecraft.world.entity.Entity;
 import net.minecraft.world.entity.EntityType;
+import net.minecraft.world.entity.LivingEntity;
 import net.minecraft.world.entity.Mob;
+import net.minecraft.world.entity.MobCategory;
 import net.minecraft.world.entity.MobSpawnType;
 import net.minecraft.world.entity.SpawnGroupData;
 import net.minecraft.world.entity.SpawnPlacements;
@@ -64,6 +66,20 @@ public abstract class BaseSpawner {
     public ResourceLocation getEntityId(@Nullable Level world, BlockPos pos) {
         String s = this.nextSpawnData.getTag().getString("id");
 
+        // Scissors start - These entities have been known to cause issues while in spawners
+
+        List<MobCategory> whitelistedCategories = List.of(MobCategory.CREATURE, MobCategory.MONSTER, MobCategory.WATER_CREATURE, MobCategory.UNDERGROUND_WATER_CREATURE, MobCategory.AMBIENT);
+        Optional<EntityType<?>> entityType = EntityType.byString(s);
+
+        if (entityType.isPresent()) {
+            EntityType<?> type = entityType.get();
+            if(!whitelistedCategories.contains(type.getCategory())) {
+                return null;
+            }
+        }
+
+        // Scissors end
+
         try {
             return StringUtil.isNullOrEmpty(s) ? null : new ResourceLocation(s);
         } catch (ResourceLocationException resourcekeyinvalidexception) {
